name: BlackBoxSign 自动签到

on:
  schedule:
    - cron: '3 3,21 * * *'
  workflow_dispatch:

jobs:
  build-and-notify:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout 仓库
        uses: actions/checkout@v3

      - name: 设置 Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '16'

      - name: 安装依赖
        run: npm install axios dotenv

      - name: 设置 Secrets 环境变量
        # GitHub 会自动将 secrets.BLACKBOX_COOKIE 和 secrets.SCKEY 作为环境变量注入
        env:
          BLACKBOX_COOKIE: ${{ secrets.BLACKBOX_COOKIE }}
          SCKEY: ${{ secrets.SCKEY }}
        run: |
          echo "Cookie 与 SCKEY 已注入环境变量"

      - name: 执行签到脚本
        run: node BlackBoxSign.js
        env:
          BLACKBOX_COOKIE: ${{ secrets.BLACKBOX_COOKIE }}
          SCKEY: ${{ secrets.SCKEY }}
